<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小红书数据爬取工具</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-danger">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fa fa-search me-2"></i>小红书数据爬取工具
            </a>
            <div class="navbar-nav ms-auto">
                <span class="nav-link text-white" id="systemStatus">
                    <i class="fa fa-circle text-success me-1"></i>系统正常
                </span>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- 搜索表单 -->
        <div class="row justify-content-center">
            <div class="col-md-10">
                <div class="card shadow-sm">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="fa fa-search me-2"></i>关键词搜索</h5>
                    </div>
                    <div class="card-body">
                        <form id="searchForm">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="mb-3">
                                        <label for="query" class="form-label">搜索关键词</label>
                                        <input type="text" class="form-control" id="query" placeholder="请输入搜索关键词，如：日本料理" required>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label for="requireNum" class="form-label">搜索数量</label>
                                        <input type="number" class="form-control" id="requireNum" min="1" max="100" value="20">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 高级选项 -->
                            <div class="mb-3">
                                <button type="button" class="btn btn-outline-secondary btn-sm" data-bs-toggle="collapse" data-bs-target="#advancedOptions">
                                    <i class="fa fa-cog me-1"></i>高级选项
                                </button>
                            </div>
                            
                            <div class="collapse" id="advancedOptions">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label for="sortType" class="form-label">排序方式</label>
                                            <select class="form-select" id="sortType">
                                                <option value="0">综合排序</option>
                                                <option value="1">最新</option>
                                                <option value="2">最多点赞</option>
                                                <option value="3">最多评论</option>
                                                <option value="4">最多收藏</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label for="noteType" class="form-label">笔记类型</label>
                                            <select class="form-select" id="noteType">
                                                <option value="0">不限</option>
                                                <option value="1">视频笔记</option>
                                                <option value="2">普通笔记</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label for="noteTime" class="form-label">时间范围</label>
                                            <select class="form-select" id="noteTime">
                                                <option value="0">不限</option>
                                                <option value="1">一天内</option>
                                                <option value="2">一周内</option>
                                                <option value="3">半年内</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label for="noteRange" class="form-label">笔记范围</label>
                                            <select class="form-select" id="noteRange">
                                                <option value="0">不限</option>
                                                <option value="1">已看过</option>
                                                <option value="2">未看过</option>
                                                <option value="3">已关注</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg" id="searchBtn">
                                    <i class="fa fa-search me-2"></i>开始搜索
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- 搜索状态提示 -->
        <div class="row justify-content-center mt-3" id="searchStatusRow" style="display: none;">
            <div class="col-md-10">
                <div class="alert" id="searchStatus">
                    <div class="d-flex align-items-center">
                        <div class="spinner-border spinner-border-sm me-2" id="searchSpinner"></div>
                        <span id="searchStatusText">正在搜索...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 搜索结果表格 -->
        <div class="row justify-content-center mt-4" id="resultsSection" style="display: none;">
            <div class="col-md-12">
                <div class="card shadow-sm">
                    <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fa fa-list me-2"></i>搜索结果</h5>
                        <div>
                            <button class="btn btn-light btn-sm me-2" id="parseAllBtn">
                                <i class="fa fa-cog me-1"></i>解析所有笔记
                            </button>
                            <button class="btn btn-outline-light btn-sm" id="exportBtn">
                                <i class="fa fa-download me-1"></i>导出数据
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="resultsTable">
                                <thead class="table-dark">
                                    <tr>
                                        <th width="5%">序号</th>
                                        <th width="15%">标题</th>
                                        <th width="10%">作者</th>
                                        <th width="8%">类型</th>
                                        <th width="8%">点赞数</th>
                                        <th width="8%">评论数</th>
                                        <th width="8%">收藏数</th>
                                        <th width="15%">发布时间</th>
                                        <th width="13%">链接</th>
                                        <th width="10%">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="resultsTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 解析状态提示 -->
        <div class="row justify-content-center mt-3" id="parseStatusRow" style="display: none;">
            <div class="col-md-10">
                <div class="alert" id="parseStatus">
                    <div class="d-flex align-items-center">
                        <div class="spinner-border spinner-border-sm me-2" id="parseSpinner"></div>
                        <span id="parseStatusText">正在解析...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 仿小红书风格的笔记详情模态框 -->
    <div class="modal fade" id="noteDetailModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content xhs-modal-content">
                <div class="modal-header xhs-modal-header">
                    <button type="button" class="btn-close xhs-close-btn" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0" id="noteDetailContent">
                    <div class="text-center p-5">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">加载中...</span>
                        </div>
                        <p class="mt-3">正在加载笔记详情...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 解析进度模态框 -->
    <div class="modal fade" id="parseProgressModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title"><i class="fa fa-cog me-2"></i>解析进度</h5>
                </div>
                <div class="modal-body">
                    <div class="progress mb-3">
                        <div class="progress-bar" id="parseProgressBar" role="progressbar" style="width: 0%">
                            0%
                        </div>
                    </div>
                    <p id="parseProgressText">正在准备解析...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 全局加载遮罩层 -->
    <div class="global-loading-overlay" id="globalLoadingOverlay" style="display: none;">
        <div class="global-loading-content">
            <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">加载中...</span>
            </div>
            <h5 class="text-primary mb-2">正在解析笔记详情</h5>
            <p class="text-muted" id="globalLoadingText">正在获取笔记完整信息...</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>